---
- name: TLS for SYSLOG | Configuration | Copy to openssl config
  copy:
    src: "/etc/ssl/openssl.cnf"
    dest: "{{ca_dir_path}}/openssl.cnf"

- name: TLS for SYSLOG | Configuration | Change default CA dir
  lineinfile:
    path: "{{ca_dir_path}}/openssl.cnf"
    firstmatch: yes
    insertafter: '[ CA_default ]'
    regexp: '^dir'
    line: 'dir             = .'

- name: TLS for SYSLOG | Configuration | Create serial and index.txt
  shell: echo "01" > serial && cp /dev/null index.txt
  args:
    chdir: "{{ca_dir_path}}"
    creates: serial
    creates: index.txt

- name: TLS for SYSLOG | Configuration | Create crlnumber
  shell: echo 1000 > ./crlnumber
  args:
    chdir: "{{ca_dir_path}}"
    creates: crlnumber
